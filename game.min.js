mh.util={PI:Math.PI,TAU:2*Math.PI,DEG_TO_RAD:.0174532925,RAD_TO_DEG:57.2957795,clamp:function(t,i,e){return Math.max(i,Math.min(e,t))},sign:function(t){return t&&t/Math.abs(t)},random:function(t,i){return 1===arguments.length?Math.random()*t-.5*t:Math.random()*(i-t)+t},randomInt:function(t,i){return 1===arguments.length?Math.floor(Math.random()*t-.5*t):Math.floor(Math.random()*(i-t+1)+t)},normalize:function(t,i,e){return(t-i)/(e-i)},getShortRotation:function(t){return t%=this.TAU,t>this.PI?t-=this.TAU:t<-this.PI&&(t+=this.TAU),t},generateID:function(){return Math.random().toString(36).slice(2)+Date.now()},isPlainObject:function(t){if("object"!=typeof t||t.nodeType||t===t.window)return!1;try{if(t.constructor&&!Object.prototype.hasOwnProperty.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},merge:function(t,i){var e=this,s=Array.isArray(i),n=s&&[]||{};return s?(t=t||[],n=n.concat(t),i.forEach(function(i,s){"undefined"==typeof n[s]?n[s]=i:e.isPlainObject(i)?n[s]=e.merge(t[s],i):t.indexOf(i)===-1&&n.push(i)}),n):(t&&e.isPlainObject(t)&&Object.keys(t).forEach(function(i){n[i]=t[i]}),Object.keys(i).forEach(function(s){i[s]&&e.isPlainObject(i[s])&&t[s]?n[s]=e.merge(t[s],i[s]):n[s]=i[s]}),n)},overwrite:function(t,i){for(var e in i)t.hasOwnProperty(e)&&i.hasOwnProperty(e)&&(t[e]=i[e])},now:function(){return window.nwf?window.nwf.system.Performance.elapsedTime:window.performance.now()},empty:function(t){for(;t.lastChild;)t.removeChild(t.lastChild)},radixSort:function(t,i,e,s){if(i=i||0,e=e||t.length,s=s||31,!(i>=e-1||s<0)){for(var n=i,h=e,o=1<<s;n<h;)if(t[n]&o){--h;var a=t[n];t[n]=t[h],t[h]=a}else++n;this.radixSort(t,i,h,s-1),this.radixSort(t,h,e,s-1)}}},mh.Emitter=function(t,i){if(i=i||{},mh.Base.call(this),this.width=10,this.height=10,this.container=mh.mh.kai.stage,this.blend=!1,this.emitType=mh.Emitter.EmitType.Point,this.emitDuration=-1,this.emitAngle=0,this.emitAngleVar=mh.util.TAU,this.emitSpeed=10,this.emitSpeedVar=0,this.emitRate=30,this.particleDuration=1,this.particleDurationVar=0,this.particleScaleInit=1,this.particleScaleVar=0,this.particleAlphaInit=1,this.particleAlphaAccel=-2,this.particleAlphaAccelDelay=.5,this.particleRotationAccel=0,this.particleRotationAccelVar=.2,this.particleRadialAccel=0,this.particleRadialAccelVar=0,this.particleTangentialAccel=0,this.particleTangentialAccelVar=0,this.particleGravity=null,mh.util.overwrite(this,i),this.particleGravity=this.particleGravity||{x:0,y:0},this.entity=t||null,this.duration=0,this.position=new mh.Vec2,!this.uri)throw new Error("[Emitter] You must pass in an image uri through the settings parameter");this.uuid=mh.util.generateID(),this.active=!1,this._force=new mh.Vec2,this._vec=new mh.Vec2,this._emitTimer=0,this._pool=new mh.DualPool(mh.Particle,this,15),this._emissionSum=0},mh.Emitter.prototype.constructor=mh.Emitter,mh.Emitter.accessor="emitter",mh.Emitter.className="EMITTER",mh.Emitter.priority=50,mh.Emitter.prototype.activate=function(){this.active=!0,this.container.addChild(this),this.visible=!0,this.duration=0,this._emissionSum=this.emitRate*mh.kai.elapsed},mh.Emitter.prototype.disable=function(){this.active=!1,this.container.removeChild(this),this._pool.freeAll()},mh.Emitter.prototype.update=function(){var t,i,e,s=this._pool.busy;if(this.duration+=mh.kai.elapsed,this.emitDuration===-1||this.duration<this.emitDuration)this._emissionSum+=this.emitRate*mh.kai.elapsed,this._emissionSum>=1&&(t=Math.floor(this._emissionSum),this.emit(t),this._emissionSum-=t);else if(0===this._pool.busy.length)return void this.disable();for(e=s.first;e;)i=e.obj,e=e.next,i.duration+=mh.kai.elapsed,i.alpha<0||i.duration>=this.particleDuration?(i.visible=!1,this._pool.recycle(i)):(i.fadeDelay<=0?i.alpha+=this.particleAlphaAccel*mh.kai.elapsed:i.fadeDelay-=mh.kai.elapsed,this._vec.set(i.vx,i.vy),this._force.copy(this._vec),this._force.multiplyScalar(i.radialAccel),this._vec.normalize(),this._vec.perp(),this._vec.multiplyScalar(i.tangentialAccel),i.vx+=(this._force.x+this._vec.x+this.particleGravity.x)*mh.kai.elapsed,i.vy+=(this._force.y+this._vec.y+this.particleGravity.y)*mh.kai.elapsed,i.position.x+=i.vx*mh.kai.elapsed,i.position.y+=i.vy*mh.kai.elapsed,i.rotation+=i.rotationAccel*mh.kai.elapsed)},mh.Emitter.prototype.dispose=function(){this.removeChildren(),this.texture.destroy(),this._pool.dispose(),this._pool=null,this.forces=null},mh.Emitter.prototype.emit=function(t){var i,e,s,n,h=mh.Emitter.EmitType;for(e=0;e<t;e++)switch(n=this._pool.get(),n.activate(),n.duration=mh.util.random(this.particleDurationVar),n.rotation=mh.util.random(this.particleRotationAccelVar*mh.util.TAU),s=this.particleScaleInit+mh.util.random(this.particleScaleVar),n.scale.set(s,s),n.alpha=this.particleAlphaInit,n.fadeDelay=this.particleAlphaAccelDelay,i=this.emitAngle+mh.util.random(this.emitAngleVar),s=this.emitSpeed+mh.util.random(this.emitSpeedVar),n.vx=Math.cos(i)*s,n.vy=-Math.sin(i)*s,n.radialAccel=this.particleRadialAccel+mh.util.random(this.particleRadialAccelVar),n.tangentialAccel=this.particleTangentialAccel+mh.util.random(this.particleTangentialAccelVar),n.rotationAccel=this.particleRotationAccel+mh.util.random(this.particleRotationAccelVar),this.emitType){case h.Rect:n.position.x=mh.util.randomInt(this._width),n.position.y=mh.util.randomInt(this._height);break;case h.Circle:i=Math.random()*mh.util.TAU,s=Math.random(),n.position.x=s*this._width*Math.cos(i),n.position.y=s*this._height*Math.sin(i);break;case h.CircleUniform:i=Math.random()*mh.util.TAU,s=Math.sqrt(Math.random()),n.position.x=s*this._width*Math.cos(i),n.position.y=s*this._height*Math.sin(i);break;case h.Ring:i=mh.util.random(mh.util.TAU),n.position.x=Math.cos(i)*this._width,n.position.y=Math.sin(i)*this._height;break;default:n.position.x=0,n.position.y=0}},mh.Emitter.EmitType={Point:0,Rect:2,Circle:4,CircleUniform:5,Ring:6},mh.Particle=function(t){this.uuid=mh.util.generateID(),t.addChildAt(this,0),this.anchor.set(.5,.5),this.active=!1,this.visible=!1,this.duration=0,this.fadeDelay=0,this.vx=0,this.vy=0,this.radialAccel=0,this.tangentialAccel=0,this.rotationAccel=0},mh.Particle.prototype.constructor=mh.Particle,mh.Particle.prototype.activate=function(){this.active=!0,this.visible=!0,this.alpha=1,this.duration=0,this.rotation=0,this.vx=0,this.vy=0,this.radialAccel=0,this.tangentialAccel=0,this.rotationAccel=0},mh.Particle.prototype.disable=function(){this.active=!1,this.visible=!1},define("DualPool",function(){var t=function(t,i,e){this._Class=t,this._freeList=new mh.LinkedList,this._busyList=new mh.LinkedList,this._settings=i||{},this._settings.pool=this,this.size=e;for(var s=0;s<this.size;s++)this._freeList.add(new this._Class(this._settings))};return t.prototype={constructor:t,get:function(){var t;return this._freeList.length?(t=this._freeList.pop(),this._busyList.add(t),t):(t=new this._Class(this._settings),this._busyList.add(t),this.size++,t)},recycle:function(t){this._busyList.has(t)&&(this._busyList.remove(t),this._freeList.add(t))},freeAll:function(){for(var t,i=this._busyList.first;i;)t=i.obj,this._busyList.remove(t),this._freeList.add(t),i=i.next},dispose:function(){this._freeList.dispose(),this._busyList.dispose(),this._freeList=null,this._busyList=null,this._Class=null,this._settings=null},toString:function(){return"[DualPool size: "+this.size+", free: "+this._freeList.length+", busy: "+this._busyList.length+"]"}},t}),define("title",{create:function(){},update:function(){},dispose:function(){}}),define("Board",{create:function(){},update:function(){},dispose:function(){}}),define("Adventure",{create:function(){var t=require("global"),i=require("Box"),e=new vg.SqrGrid({cellSize:10});e.generate({size:10});var s=new vg.Board(e),n=new vg.GeneratedTileManager(s);n.makeTiles(50),mh.kai.view.add(s.group),mh.kai.view.focusOn(s.group);new i(new THREE.Vector3);t.board=s,t.grid=e},update:function(){mh.kai.view.render()},dispose:function(){}}),define(function(t){t("src/lib/three.min.js");var i=t("core/Kai"),e=t("entities/World"),s=t("entities/Box3"),n=function(){this.objects=[],this.player=null,this.renderer=null,this.boxSize=50,this.scene=null,this.raycaster=null,this.camera=null,this.projector=null,this.plane=null,this.intersector=null,this.normalMatrix=null,this.tmpVec=null,this.voxelPosition=null,this.rollOverMesh=null,this.cubeGeo=null,this.cubeMaterial=null,this.mouse2D=null,this.theta=0};return n.prototype={preload:function(){},create:function(){e.width=100,e.height=100,e.depth=100,this.objects=[],this.rebuildCanvas();var t=document.getElementsByTagName("canvas")[0];this.camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e4),this.camera.position.y=800,this.scene=new THREE.Scene;var n=new THREE.CubeGeometry(this.boxSize,this.boxSize,this.boxSize),h=new THREE.MeshBasicMaterial({color:16711680,opacity:.5,transparent:!0});this.rollOverMesh=new THREE.Mesh(n,h),this.scene.add(this.rollOverMesh),this.projector=new THREE.Projector,this.voxelPosition=new THREE.Vector3,this.tmpVec=new THREE.Vector3,this.normalMatrix=new THREE.Matrix3;for(var o=10*this.boxSize,a=new THREE.Geometry,r=-o;r<=o;r+=this.boxSize)a.vertices.push(new THREE.Vector3((-o),0,r)),a.vertices.push(new THREE.Vector3(o,0,r)),a.vertices.push(new THREE.Vector3(r,0,(-o))),a.vertices.push(new THREE.Vector3(r,0,o));var l=new THREE.LineBasicMaterial({color:0,opacity:.2,transparent:!0}),c=new THREE.Line(a,l);c.type=THREE.LinePieces,this.scene.add(c),this.plane=new THREE.Mesh(new THREE.PlaneGeometry(1e3,1e3),new THREE.MeshBasicMaterial),this.plane.rotation.x=-Math.PI/2,this.plane.visible=!1,this.scene.add(this.plane),this.mouse2D=new THREE.Vector3(0,1e4,.5);var u=new THREE.AmbientLight(6316128);this.scene.add(u);var m=new THREE.DirectionalLight(16777215);m.position.set(1,.75,.5).normalize(),this.scene.add(m),this.renderer=new THREE.WebGLRenderer({canvas:t,antialias:!0}),this.renderer.setClearColor(15790320),this.renderer.setSize(window.innerWidth,window.innerHeight),i.view=this.scene,i.renderHook=this.draw.bind(this),i.mouse.onDown.add(this.mouseDown,this),i.keys.onDown.add(this.keyDown,this),this.player=new s(new THREE.Vector3),this.player.position.y=o,this.player.reset(),this.objects.push(this.player)},keyDown:function(t){switch(t){case i.keys.W:this.player.velocity.z=10;break;case i.keys.S:this.player.velocity.z=10;break;case i.keys.A:this.player.velocity.x=10;break;case i.keys.D:this.player.velocity.x=10;break;case i.keys.SPACEBAR:this.player.velocity.y=-50}},keyUp:function(t,e){switch(t){case i.keys.W:this.player.velocity.z=0;break;case i.keys.S:this.player.velocity.z=0;break;case i.keys.A:this.player.velocity.x=0;break;case i.keys.D:this.player.velocity.x=0}},mouseDown:function(t){var e=this.raycaster.intersectObjects(this.scene.children);if(e.length>0)if(this.intersector=this.getRealIntersector(e),i.keys.ctrl)this.intersector.object!=this.plane&&this.scene.remove(this.intersector.object);else{this.intersector=this.getRealIntersector(e),this.setVoxelPosition(this.intersector);var n=new s(this.voxelPosition,this.boxSize);n.reset(),this.objects.push(n)}},update:function(){this.mouse2D.x=i.mouse.position.x/window.innerWidth*2-1,this.mouse2D.y=2*-(i.mouse.position.y/window.innerHeight)+1,i.keys.shift&&(this.theta+=1.5*this.mouse2D.x),this.raycaster=this.projector.pickingRay(this.mouse2D.clone(),this.camera);var t=this.raycaster.intersectObjects(this.scene.children);t.length>0&&(this.intersector=this.getRealIntersector(t),this.intersector&&(this.setVoxelPosition(this.intersector),this.rollOverMesh.position=this.voxelPosition)),this.camera.position.x=1400*Math.sin(.017453292*this.theta),this.camera.position.z=1400*Math.cos(.017453292*this.theta),this.camera.lookAt(this.scene.position)},draw:function(){this.renderer.render(this.scene,this.camera)},setVoxelPosition:function(t){this.normalMatrix.getNormalMatrix(t.object.matrixWorld),this.tmpVec.copy(t.face.normal),this.tmpVec.applyMatrix3(this.normalMatrix).normalize(),this.voxelPosition.addVectors(t.point,this.tmpVec),this.voxelPosition.x=50*Math.floor(this.voxelPosition.x/50)+25,this.voxelPosition.y=50*Math.floor(this.voxelPosition.y/50)+25,this.voxelPosition.z=50*Math.floor(this.voxelPosition.z/50)+25},getRealIntersector:function(t){var i,e;for(i=0;i<t.length;i++)if(e=t[i],e.object!=this.rollOverMesh)return e;return null},rebuildCanvas:function(){var t=document.getElementsByTagName("canvas")[0];document.body.removeChild(t),t=document.createElement("canvas"),document.body.insertBefore(t,document.getElementById("debug"))},dispose:function(){var t,e;for(t=0;t<this.total;t++)e=this.objects[t],e.dispose();this.objects.length=0,i.mouse.onDown.remove(this.mouseDown,this),i.view=null,this.scene=null,this.raycaster=null,this.camera=null,this.projector=null,this.plane=null,this.intersector=null,this.normalMatrix=null,this.tmpVec=null,this.voxelPosition=null,this.rollOverMesh=null,this.cubeGeo=null,this.cubeMaterial=null,this.mouse2D=null,this.rebuildCanvas()}},n}),define("Box",function(){var t=function(t,i){i=i||{},mh.Base.call(this);var e=require("global");this.size=50,this.dynamic=!0;var s={size:this.size,dynamic:this.dynamic};mh.util.merge(s,i),this.position=t.clone(),this.velocity=new THREE.Vector3,mh.kai.addComponent(this,e.Components.THREE_CUBE,s),mh.kai.addComponent(this,e.Components.AABB3,s)};return t.prototype={constructor:t,activate:function(){this.view.active=!0,this.body.active=!0},dispose:function(){mh.kai.removeComponent(this,g.Components.THREE_CUBE),mh.kai.removeComponent(this,g.Components.AABB3),this.position=null,this.velocity=null}},t}),mh.XboxGamepad=function(t){mh.Base.call(this),this.id=t,this.onDown=new mh.Signal,this.onUp=new mh.Signal,this.leftAxis=new mh.Vec2,this.rightAxis=new mh.Vec2,this.leftTrigger=0,this.rightTrigger=0,this.axisTolerance=.2,this.controller=null,this.buttons=null,this._numButtons=0,this._mozAxisOffset=0,this._prevButtons=[]},mh.XboxGamepad.prototype={constructor:mh.XboxGamepad,register:function(t){this.setPad(t),this._numButtons=this.buttons.length,navigator.webkitGetGamepads?this._mozAxisOffset=0:this._mozAxisOffset=1,this.activate()},setPad:function(t){this.controller=t,this.buttons=t.buttons},unregister:function(){this.controller=null,this.buttons=null,this._numButtons=0},update:function(){var t,i,e=this.controller.axes[0],s=this.controller.axes[1],n=this.controller.axes[2+this._mozAxisOffset],h=this.controller.axes[3+this._mozAxisOffset];for(e<this.axisTolerance&&e>-this.axisTolerance&&(e=0),s<this.axisTolerance&&s>-this.axisTolerance&&(s=0),n<this.axisTolerance&&n>-this.axisTolerance&&(n=0),h<this.axisTolerance&&h>-this.axisTolerance&&(h=0),this.leftAxis.x=e,this.leftAxis.y=s,this.rightAxis.x=n,this.rightAxis.y=h,t=0;t<this._numButtons;t++)i=this.buttons[t],6===t?this.leftTrigger=i.value||i:7===t&&(this.rightTrigger=i.value||i),i&&!this._prevButtons[t]?this.onDown.dispatch(t,i):!i&&this._prevButtons[t]&&this.onUp.dispatch(t,i),this._prevButtons[t]=i},isDown:function(t){return!(mh.kai.inputBlocked||!this.active)&&!!this.buttons[t]},activate:function(){this.active=!0,this.leftAxis.x=0,this.leftAxis.y=0,this.rightAxis.x=0,this.rightAxis.y=0,this.leftTrigger=0,this.rightTrigger=0;for(var t=0;t<this._numButtons;t++)this.buttons[t]=0,this._prevButtons[t]=0},disable:function(){this.active=!1},dispose:function(){this.onDown.dispose(),this.onUp.dispose(),this.onDown=null,this.onUp=null}},mh.XBOX={A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,SELECT:8,START:9,LSTICK:10,RSTICK:11,UP:12,DOWN:13,LEFT:14,RIGHT:15},mh.Timer=function(t,i){i=i||{},mh.Base.call(this),this.repeat=-1,this.immediateDispatch=!1,this.interval=1e3,mh.util.overwrite(this,i),this.onInterval=new mh.Signal,this.entity=t,this._timer=0,this._numTicks=0,this._currentRepeat=this.repeat,this.disable()},mh.Timer.accessor="timer",mh.Timer.className="TIMER",mh.Timer.priority=13,mh.Timer.prototype={constructor:mh.Timer,activate:function(){this._timer=performance.now(),this.active=!0,this._currentRepeat=this.repeat,this._numTicks=0,this.immediateDispatch&&(this._numTicks++,this.onInterval.dispatch(this._numTicks))},disable:function(){this.active=!1},reset:function(){this._timer=performance.now(),this._numTicks=0,this.active&&this.immediateDispatch&&(this._numTicks++,this.onInterval.dispatch(this._numTicks))},update:function(){if(performance.now()-this._timer>=this.interval){if(this._numTicks++,this.onInterval.dispatch(this._numTicks),this.repeat!==-1&&0===this._currentRepeat--)return void this.disable();this._timer=performance.now()}},dispose:function(){this.onInterval.dispose(),this.onInterval=null,this.entity=null}},mh.THREECube=function(t,i){i=i||{},mh.Base.call(this),this.textureUrl=null,this.container=mh.kai.view,this.size=[5,10,5],this.color=1401481,this.emissive=468276,mh.util.overwrite(this,i),this.entity=t,this._display=null;var e=new THREE.CubeGeometry(this.size[0],this.size[1],this.size[2]),s=new THREE.MeshPhongMaterial({color:1401481,emissive:468276,shading:THREE.FlatShading,map:this.textureUrl?THREE.ImageUtils.loadTexture(this.textureUrl):null});this._display=new THREE.Mesh(e,s),this.position=mh.kai.expect(t,"position",THREE.Vector3),this.rotation=mh.kai.expect(t,"rotation",THREE.Vector3)},mh.THREECube.accessor="view",mh.THREECube.className="VIEW_CUBE",mh.THREECube.priority=10,mh.THREECube.prototype={constructor:mh.THREECube,activate:function(){this.active=!0,this.container.add(this._display)},disable:function(){this.active=!1,this.container.remove(this._display)},update:function(){this._display.position.copy(this.position),this._display.rotation.setFromVector3(this.rotation)},dispose:function(){this.disable(),this.entity=null,this.position=null,this._display=null}},mh.StackFSM=function(t){mh.Base.call(this),this.state=null,this.stack=[],this.entity=t,this.stateChanged=new mh.Signal,this._activeContext=null,this._activeFunction=null,this._prevFunction=null},mh.StackFSM.accessor="stack",mh.StackFSM.className="STACK_FSM",mh.StackFSM.priority=5,mh.StackFSM.post=!1,mh.StackFSM.prototype={constructor:mh.StackFSM,activate:function(){this.active=!0},disable:function(){this.active=!1,this.reset()},reset:function(){this.stack.length=0,this._prevFunction=null,this._activeFunction=null},pushState:function(t,i){t!==this._activeFunction&&(this.stack.push(t),this._activeContext=i,this.active||this.activate())},popState:function(){this.stack.pop(),this._activeFunction=this.stack.length?this.stack[this.stack.length-1]:null,this._activeFunction||(this.stateChanged.dispatch(this.state,"null"),this._prevFunction=null,this.disable())},update:function(){this._activeFunction=this.stack.length?this.stack[this.stack.length-1]:null,this._activeFunction&&(this._activeFunction!==this._prevFunction&&(this.state=this._activeFunction.name,this.stateChanged.dispatch(this._prevFunction?this._prevFunction.name:"null",this.state),this._prevFunction=this._activeFunction),this._activeFunction.call(this._activeContext))},dispose:function(){this.entity=null,this._activeFunction=null,this._prevFunction=null,this.stack=null,this.stateChanged.dispose(),this.stateChanged=null}},mh.Health=function(t,i){i=i||{},mh.Base.call(this),this.max=100,this.overage=0,this.alive=!1,this.active=!1,mh.util.overwrite(this,i),this.onDeath=new mh.Signal,this.onDamage=new mh.Signal,this.onHeal=new mh.Signal,this.onFull=new mh.Signal,this.onActivate=new mh.Signal,this.entity=t,this._meter=0},mh.Health.accessor="health",mh.Health.className="HEALTH",mh.Health.priority=1,mh.Health.prototype={constructor:mh.Health,activate:function(){this._meter=this.max,this.alive=!0,this.onActivate.dispatch(this._meter,this.entity)},change:function(t){return this.alive?(this._meter+=t,this._meter<=0?(this._meter=0,this.alive=!1,this.onDeath.dispatch(t,this.entity)):(this._meter>this.max+this.overage&&(this._meter=this.max,this.onFull.dispatch(t)),t<0?this.onDamage.dispatch(t):this.onHeal.dispatch(t)),this._meter):0},drain:function(t){return this.alive?(this._meter>this.max&&(this._meter-=t,this._meter<=this.max&&(this._meter=this.max,this.onFull.dispatch(t))),this._meter):0},dispose:function(){this.onDeath.dispose(),this.onDamage.dispose(),this.onHeal.dispose(),this.onFull.dispose(),this.entity=null,this.deathSignal=null,this.onDamage=null,this.onHeal=null,this.onFull=null}},mh.GamepadController=function(){this.controllers=[],this.onConnect=new mh.Signal,this.onDisconnect=new mh.Signal,this.activeControllers=0,this._controllerStatus=[];for(var t=0;t<4;t++)this.controllers[t]=new mh.XboxGamepad(t),this._controllerStatus[t]=!1;window.addEventListener("gamepadconnected",this._onConnect.bind(this),!1),window.addEventListener("gamepaddisconnected",this._onDisconnect.bind(this),!1)},mh.GamepadController.prototype={constructor:mh.GamepadController,update:function(){var t,i;for(navigator.webkitGetGamepads&&this._scan(),t=0;t<4;t++)i=this.controllers[t],i.active&&i.update()},dispose:function(){this.controllers=null,this.onConnect.dispose(),this.onDisconnect.dispose(),this.onConnect=null,this.onDisconnect=null,this._controllerStatus=null},_addPad:function(t){var i=this.controllers[t.index];i.register(t),i.activate(),this.onConnect.dispatch(i),this.activeControllers++},_removePad:function(t){var i=t.index?this.controllers[t.index]:this.controllers[t];i.unregister(),this.onDisconnect.dispatch(i),this.activeControllers--},_onConnect:function(t){this._addPad(t.gamepad)},_onDisconnect:function(t){this._removePad(t.gamepad)},_scan:function(){var t,i=navigator.webkitGetGamepads();for(t=0;t<i.length;t++)i[t]?this._controllerStatus[t]?this.controllers[t].setPad(i[t]):(this._addPad(i[t]),this._controllerStatus[t]=!0):!i[t]&&this._controllerStatus[t]&&(this._removePad(t),this._controllerStatus[t]=!1)}},define("AABB3",function(){var t=function(t,i){i=i||{},mh.Base.call(this),this.foo=config.foo,mh.util.overwrite(this,i),this.entity=t,this.position=mh.kai.expect(t,"position",THREE.Vector3)};return t.accessor="body",t.className="AABB3",t.priority=10,t.post=!1,t.prototype={constructor:t,activate:function(){this.active=!0},disable:function(){this.active=!1},update:function(){},dispose:function(){this.entity=null,this.position=null}},t}),define("global",{board:null,grid:null,broadphase:null,nextLevel:0,Components:null}),function(){var t=new mh.Engine,i=require("global");mh.kai.view=new vg.Scene({element:document.getElementById("stage"),cameraPosition:{x:0,y:150,z:150}},(!0)),i.Components=mh.kai.registerComponents([mh.THREECube,mh.StackFSM,require("AABB3")]);var e="Adventure";t.state.add(e,require(e)),t.start(e)}();
//# sourceMappingURL=game.min.js.map
